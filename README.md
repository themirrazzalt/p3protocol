# The P3 Network Protocol
> Note: the P3 network and protocol were developed by [Sys36](https://sys36.net/), creators of [Windows 96](https://windows96.net/).
> This documentation is unofficial.

## What is P3?
> Fun fact: during the development of Windows 96 v3, P3 was intended to be replaced by a new WIP system called "Bell". When the release of v3 was nearing, Bell was nowhere near finished, so it was removed from some of the later beta builds, as well as the initial relase, and P3 was left in. 
P3 (aka PPP/Psuedo P2P) is a network developed by Sys36 for use in the Windows 96 web OS.
A P3 network consists of 2 types of devices: the P3 server, and the devices using the P3 network.
P3 uses SocketIO to simulate a P2P network over WebSockets and HTTP(s). The main goal is to have P2P-like functionality within Windows 96.

## P3 Network "Relay" Server
The server is the most important part. It operates basically the entire network.
Without a P3 network "relay" server, you wouldn't be able to simulate a P2P network.

## P3 Keys
A P3 key is base-64 encoded text. These keys are usually generated by generating random hexidecimals or text, and then encoding them with base-64.
A P3 key is used to allow the relay server to identify which device you are on.
The server then assigns you a P3 address, a collection of random letters and numbers that ends in `.ppp`.
Your P3 address is associated with your P3 key, so transferring your P3 key to a different device allows you to retain your current P3 address.

## Connection and Handshake
When your device connects to a P3 network, it sends the `hello` event to the relay server.
It includes one paramater, which is your P3 key.
> Fun fact: when decoded, this base-64 data says "your key here".
```json
"eW91ciBrZXkgaGVyZQ=="
```

Your device then recieves a `hello` event from the relay server.
If your device successfully connects to the P3 network, the response will contain data similar to this:
```json
{
  "success": true,
  "address": "ba9odkq4d.ppp"
}
```
If your device doesn't connect successfully, the relay server will send data similar to this:
> Fun fact: the most commonly recieved error message is `PPP Server Error: Address already in use`, which means that your trying to use a key that is being used on a device already connected to the P3 network.
```json
{
  "success": false,
  "message": "PPP Server Error: <insert error message here>"
}
```

## Hosting a server over P3
When someone tries to connect to your P3 address, they also specify a port to connect to. To my knowledge, a P3 port can be any number, and isn't limited, unlike ports over typical IP connections (this isn't known for sure, though).
Your device recieves data formatted like the following through the `packet` event:
```json
{
  "port": 1234,
  "data": {
    "type": "connect",
    "responsePort": 19419
  },
  "source": "ak4jd7xa0e.ppp"
}
```
If your server wants to allow the connection, it'd send a similar response back through the `packet` stream:
```json
{
  "data": {
    "type": "ack",
    "message": "Connection accepted",
    "heartbeat": 15000,
    "nonce": 0,
    "peerID": "aGRrSkZJbmRERihFN2ViIGprLEhKTURoa2RvSk1DTVM=",
    "code": 100,
    "success": true
  },
  "dest": "ak4jd7xa0e.ppp:19419",
  "nonce": 0
}
```
The peer ID is generated using the same method as the P3 key is, except it uses more letters. The peer ID uniquely identifies the client-server connection to avoid confusing it with other possible connections.

## Sending messages
Messages can be sent using the same `packet` event 
